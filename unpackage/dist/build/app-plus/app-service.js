if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((i=>t.resolve(e()).then((()=>i))),(i=>t.resolve(e()).then((()=>{throw i}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...i){uni.__log__?uni.__log__(e,t,...i):console[e].apply(console,[...i,t])}const i=(e,t)=>{const i=e.__vccOpts||e;for(const[n,a]of t)i[n]=a;return i},n=3,a=100,s=10,r=1e4,o=5,l=1e3,c=2,u={async fetchRandomArticle(e){const i=`https://${e}.wikipedia.org/api/rest_v1/page/random/summary`,n={"User-Agent":"WikiTok/1.0 (https://github.com/your-username/wikitok; your-email@example.com) UniApp/3.0",Accept:"application/json","Accept-Language":e};try{const e=await Promise.race([uni.request({url:i,method:"GET",header:n}),new Promise(((e,t)=>setTimeout((()=>t(new Error("ËØ∑Ê±ÇË∂ÖÊó∂"))),r)))]);if(!e.data||200!==e.statusCode)throw new Error(`APIÂìçÂ∫îÈîôËØØ: ${e.statusCode}`);return e.data}catch(a){throw t("error","at pages/index/index.vue:93","Wiki APIËØ∑Ê±ÇÂ§±Ë¥•:",a),a}}},p={validateWikiData(e){var t,i;return Boolean((null==e?void 0:e.title)&&(null==e?void 0:e.extract)&&(null==(i=null==(t=null==e?void 0:e.content_urls)?void 0:t.desktop)?void 0:i.page)&&"string"==typeof e.title&&"string"==typeof e.extract&&"string"==typeof e.content_urls.desktop.page)},processImageUrl(e){if(!e)return"/static/default-bg.jpg";try{return e.replace(/^http:/,"https:")}catch(i){return t("error","at pages/index/index.vue:119","ÂõæÁâáURLÂ§ÑÁêÜÂ§±Ë¥•:",i),"/static/default-bg.jpg"}},getBestImageUrl(e){var t;return e.thumbnail?(null==(t=e.originalimage)?void 0:t.source)?e.originalimage.source:e.thumbnail.source?e.thumbnail.source.replace(/\/\d+px-/,"/800px-"):null:null}};const h=i({data:()=>({wikiItems:[],languages:{names:["‰∏≠Êñá","English","Espa√±ol","Fran√ßais","Êó•Êú¨Ë™û","Deutsch","Italiano","Portugu√™s","–†—É—Å—Å–∫–∏–π","ÌïúÍµ≠Ïñ¥","ÿßŸÑÿπÿ±ÿ®Ÿäÿ©","‡§π‡§ø‡§®‡•ç‡§¶‡•Ä","Nederlands","Polski","Svenska","–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞","Ti·∫øng Vi·ªát","‡πÑ‡∏ó‡∏¢"],codes:["zh","en","es","fr","ja","de","it","pt","ru","ko","ar","hi","nl","pl","sv","uk","vi","th"]},currentLanguageIndex:0,isLoading:!1,currentIndex:0,statusBarHeight:20,retryCount:0,isLoadingMore:!1,isInitialized:!1}),computed:{currentLanguageCode(){return this.languages.codes[this.currentLanguageIndex]}},async onLoad(){this.statusBarHeight=uni.getSystemInfoSync().statusBarHeight,await this.loadInitialData()},methods:{async loadInitialData(){this.isLoading=!0,this.wikiItems=[],this.currentIndex=0;try{const e=[];for(let t=0;t<n;t++){const t=await this.fetchArticleWithRetry();t&&e.push(t)}e.length>0&&(await this.$nextTick(),this.wikiItems=e,this.currentIndex=0,this.isInitialized=!0)}catch(e){this.handleLoadError(e)}finally{this.isLoading=!1}},async fetchArticleWithRetry(){let e=0;for(;e<o;)try{const e=await u.fetchRandomArticle(this.currentLanguageCode);if(!p.validateWikiData(e))throw new Error("Êó†ÊïàÁöÑÁª¥Âü∫Êï∞ÊçÆÁªìÊûÑ");return this.transformWikiData(e)}catch(i){if(e++,e===o)throw i;t("log","at pages/index/index.vue:212",`Ê≠£Âú®ËøõË°åÁ¨¨ ${e} Ê¨°ÈáçËØï...`),await new Promise((e=>setTimeout(e,l)))}},transformWikiData(e){const t=p.getBestImageUrl(e),i=p.processImageUrl(t);return{title:e.title,excerpt:e.extract,image:i||"/static/default-bg.jpg",url:e.content_urls.desktop.page}},handleLoadError(e){t("error","at pages/index/index.vue:231","Âä†ËΩΩÊñáÁ´†Â§±Ë¥•:",e),uni.showToast({title:e.message||"Âä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªú",icon:"none",duration:2e3})},saveToHistory(e){if(e)try{let t=uni.getStorageSync("wikiHistory")||[];if(!t.some((t=>t.url===e.url))){const i={...e,timestamp:Date.now()};t=[...t,i].slice(0,a),uni.setStorageSync("wikiHistory",t)}}catch(i){t("error","at pages/index/index.vue:255","‰øùÂ≠òÂéÜÂè≤ËÆ∞ÂΩïÂ§±Ë¥•:",i)}},onLanguageChange(e){this.currentLanguageIndex=e.detail.value,this.wikiItems=[],this.currentIndex=0,this.loadInitialData()},async onSwiperChange(e){const t=e.detail.current;t!==this.currentIndex&&(this.saveToHistory(this.wikiItems[t]),this.currentIndex=t,await this.checkAndLoadMore())},onAnimationFinish(){!this.isLoadingMore&&this.currentIndex>=this.wikiItems.length-c&&this.checkAndLoadMore()},async checkAndLoadMore(){if(this.isLoadingMore)return;if(this.wikiItems.length-(this.currentIndex+1)<c){this.isLoadingMore=!0;try{const e=await this.fetchArticleWithRetry();e&&(this.wikiItems.push(e),this.wikiItems.length>s&&(this.wikiItems=this.wikiItems.slice(-s),this.currentIndex=Math.max(0,this.currentIndex-1)))}catch(e){this.handleLoadError(e)}finally{this.isLoadingMore=!1}}},openWikiPage(e){uni.navigateTo({url:`/pages/webview/webview?url=${encodeURIComponent(e)}`})},openHistory(){uni.navigateTo({url:"/pages/profile/profile"})},handleImageError(e){e&&(e.image="/static/default-bg.jpg")}},watch:{wikiItems:{handler(e,t){0===t.length&&e.length>0&&this.$nextTick((()=>{this.currentIndex=0}))},deep:!0}}},[["render",function(t,i,n,a,s,r){return e.openBlock(),e.createElementBlock("view",{class:"container"},[s.wikiItems.length>0?(e.openBlock(),e.createElementBlock("swiper",{key:0,class:"swiper",vertical:"",onChange:i[3]||(i[3]=(...e)=>r.onSwiperChange&&r.onSwiperChange(...e)),onAnimationfinish:i[4]||(i[4]=(...e)=>r.onAnimationFinish&&r.onAnimationFinish(...e)),current:s.currentIndex,"disable-touch":s.isLoading||s.isLoadingMore,duration:200,circular:!0,"skip-hidden-item-layout":!0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.wikiItems,((t,n)=>(e.openBlock(),e.createElementBlock("swiper-item",{key:t.url},[e.createElementVNode("view",{class:e.normalizeClass(["wiki-item",{"wiki-item-active":n===s.currentIndex}])},[e.createElementVNode("image",{class:"background-image",src:t.image,mode:"aspectFill",onError:e=>r.handleImageError(t),"lazy-load":!0},null,40,["src","onError"]),e.createElementVNode("view",{class:"content-overlay"},[e.createElementVNode("view",{class:"top-bar",style:e.normalizeStyle({top:s.statusBarHeight+"px"})},[e.createElementVNode("view",{class:"language-selector"},[e.createElementVNode("picker",{onChange:i[0]||(i[0]=(...e)=>r.onLanguageChange&&r.onLanguageChange(...e)),value:s.currentLanguageIndex,range:s.languages.names,onClick:i[1]||(i[1]=e.withModifiers((()=>{}),["stop"])),disabled:s.isLoading||s.isLoadingMore},[e.createElementVNode("text",{class:"language-text"},e.toDisplayString(s.languages.names[s.currentLanguageIndex]),1)],40,["value","range","disabled"])]),e.createElementVNode("view",{class:"history-btn",onClick:i[2]||(i[2]=(...e)=>r.openHistory&&r.openHistory(...e))},[e.createElementVNode("text",{class:"history-text"},"ÂéÜÂè≤")])],4),e.createElementVNode("view",{class:"wiki-content",onClick:e.withModifiers((e=>r.openWikiPage(t.url)),["stop"])},[e.createElementVNode("text",{class:"wiki-title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:"wiki-excerpt"},e.toDisplayString(t.excerpt),1),s.isLoadingMore&&n===s.wikiItems.length-1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-overlay"},[e.createElementVNode("text",{class:"loading-text"},"Ê≠£Âú®Âä†ËΩΩÊõ¥Â§ö...")])):e.createCommentVNode("",!0)],8,["onClick"])])],2)])))),128))],40,["current","disable-touch"])):e.createCommentVNode("",!0),s.isLoading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-indicator"},[e.createElementVNode("text",{class:"loading-text"},"Âä†ËΩΩ‰∏≠...")])):e.createCommentVNode("",!0)])}]]);const g=i({data:()=>({url:""}),onLoad(e){e.url&&(this.url=decodeURIComponent(e.url))}},[["render",function(t,i,n,a,s,r){return e.openBlock(),e.createElementBlock("view",{class:"webview-container"},[e.createElementVNode("web-view",{src:s.url},null,8,["src"])])}]]);const d=i({data:()=>({historyList:[],statusBarHeight:0,isRefreshing:!1,activeIndex:-1}),onLoad(){this.statusBarHeight=uni.getSystemInfoSync().statusBarHeight},onShow(){this.loadHistory()},methods:{loadHistory(){try{const e=uni.getStorageSync("wikiHistory")||[];this.historyList=e.reverse().map((e=>({...e,timestamp:e.timestamp||Date.now()})))}catch(e){t("error","at pages/profile/profile.vue:89","Âä†ËΩΩÂéÜÂè≤ËÆ∞ÂΩïÂ§±Ë¥•:",e),uni.showToast({title:"Âä†ËΩΩÂéÜÂè≤ËÆ∞ÂΩïÂ§±Ë¥•",icon:"none"})}},clearHistory(){uni.showModal({title:"Ê∏ÖÁ©∫ÂéÜÂè≤ËÆ∞ÂΩï",content:"Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÂéÜÂè≤ËÆ∞ÂΩïÂêóÔºü",confirmColor:"#ff5a5f",success:e=>{if(e.confirm)try{uni.removeStorageSync("wikiHistory"),this.historyList=[],uni.showToast({title:"Â∑≤Ê∏ÖÁ©∫",icon:"success"})}catch(i){t("error","at pages/profile/profile.vue:111","Ê∏ÖÁ©∫ÂéÜÂè≤ËÆ∞ÂΩïÂ§±Ë¥•:",i),uni.showToast({title:"Êìç‰ΩúÂ§±Ë¥•",icon:"none"})}}})},openWikiPage(e,t){this.activeIndex=t,setTimeout((()=>{uni.navigateTo({url:`/pages/webview/webview?url=${encodeURIComponent(e)}`})}),150)},formatTime(e){const t=new Date(e),i=new Date-t;if(i<36e5){return`${Math.floor(i/6e4)}ÂàÜÈíüÂâç`}if(i<864e5){return`${Math.floor(i/36e5)}Â∞èÊó∂Ââç`}if(i<6048e5){return`${Math.floor(i/864e5)}Â§©Ââç`}return`${t.getMonth()+1}Êúà${t.getDate()}Êó•`},onPulling(){},async onRefresh(){this.isRefreshing=!0,await this.loadHistory(),setTimeout((()=>{this.isRefreshing=!1}),1e3)}}},[["render",function(t,i,n,a,s,r){return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"header-content"},[e.createElementVNode("text",{class:"title"},"ÂéÜÂè≤ËÆ∞ÂΩï"),e.createElementVNode("view",{class:"clear-btn-wrapper",onClick:i[0]||(i[0]=(...e)=>r.clearHistory&&r.clearHistory(...e))},[e.createElementVNode("text",{class:"clear-icon"},"üóë"),e.createElementVNode("text",{class:"clear-text"},"Ê∏ÖÁ©∫")])])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"history-list","refresher-enabled":!0,"refresher-triggered":s.isRefreshing,onRefresherpulling:i[1]||(i[1]=(...e)=>r.onPulling&&r.onPulling(...e)),onRefresherrefresh:i[2]||(i[2]=(...e)=>r.onRefresh&&r.onRefresh(...e))},[0===s.historyList.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"üìú"),e.createElementVNode("text",{class:"empty-text"},"ÊöÇÊó†ÊµèËßàËÆ∞ÂΩï"),e.createElementVNode("text",{class:"empty-tip"},"ÊµèËßàÁöÑÊñáÁ´†‰ºöÊòæÁ§∫Âú®ËøôÈáå")])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"history-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.historyList,((t,i)=>(e.openBlock(),e.createElementBlock("view",{key:i,class:e.normalizeClass(["history-item",{"history-item-active":s.activeIndex===i}]),onClick:e=>r.openWikiPage(t.url,i)},[e.createElementVNode("view",{class:"item-main"},[e.createElementVNode("image",{class:"item-image",src:t.image,mode:"aspectFill"},[t.image?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"image-placeholder"},[e.createElementVNode("text",{class:"placeholder-text"},"Wiki")]))],8,["src"]),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("text",{class:"item-title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:"item-excerpt"},e.toDisplayString(t.excerpt),1)])]),e.createElementVNode("view",{class:"item-footer"},[e.createElementVNode("text",{class:"item-time"},e.toDisplayString(new Date(t.timestamp).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})),1)])],10,["onClick"])))),128))]))],40,["refresher-triggered"])])}]]);__definePage("pages/index/index",h),__definePage("pages/webview/webview",g),__definePage("pages/profile/profile",d);const m={onLaunch:function(){t("log","at App.vue:4","App Launch")},onShow:function(){t("log","at App.vue:7","App Show")},onHide:function(){t("log","at App.vue:10","App Hide")}};const y=uni.getSystemInfoSync(),_="4.45",f="https://tongji.dcloud.io/uni/stat",v="__UNI__CD46827",w=(e,t)=>{let i=uni.getStorageSync("$$STAT__DBDATA:"+v)||{};i||(i={}),i[e]=t,uni.setStorageSync("$$STAT__DBDATA:"+v,i)},S=e=>{let t=uni.getStorageSync("$$STAT__DBDATA:"+v)||{};if(!t[e]){let i=uni.getStorageSync("$$STAT__DBDATA:"+v);if(i||(i={}),!i[e])return;t[e]=i[e]}return t[e]},k=e=>{let t=uni.getStorageSync("$$STAT__DBDATA:"+v)||{};t[e]?(delete t[e],uni.setStorageSync("$$STAT__DBDATA:"+v,t)):(t=uni.getStorageSync("$$STAT__DBDATA:"+v),t[e]&&(delete t[e],uni.setStorageSync("$$STAT__DBDATA:"+v,t)))},T={enable:!0,version:"1"};let A={};A={"pages/webview/webview":"Áª¥Âü∫ÁôæÁßë","pages/profile/profile":"ÂéÜÂè≤ËÆ∞ÂΩï"};const I="__DC_STAT_UUID",D="__DC_UUID_VALUE";function E(){let e="";if("n"===N()){try{e=plus.runtime.getDCloudId()}catch(t){e=""}return e}try{e=uni.getStorageSync(I)}catch(t){e=D}if(!e){e=Date.now()+""+Math.floor(1e7*Math.random());try{uni.setStorageSync(I,e)}catch(t){uni.setStorageSync(I,D)}}return e}const x={appid:"__UNI__CD46827"},N=()=>{const e={app:"n","app-plus":"n","app-harmony":"n","mp-harmony":"mhm",h5:"h5","mp-weixin":"wx",[["y","a","p","mp-ali"].reverse().join("")]:"ali","mp-baidu":"bd","mp-toutiao":"tt","mp-qq":"qq","quickapp-native":"qn","mp-kuaishou":"ks","mp-lark":"lark","quickapp-webview":"qw","mp-xhs":"xhs"};if("ali"===e.app&&my&&my.env){const e=my.env.clientName;if("ap"===e)return"ali";if("dingtalk"===e)return"dt"}return e.app||"app"},R=e=>{const t=N();let i="";return e||("wx"===t&&(i=uni.getLaunchOptionsSync().scene),i)},b=e=>{let t="";for(var i in e)t+=i+"="+e[i]+"&";return t.substr(0,t.length-1)},L=e=>{let t=e||q();if("bd"===N()){let e=t.$mp&&t.$mp.page&&t.$mp.page.is,i=t.$scope&&t.$scope.is;return e||i||""}return t.route||t.$scope&&t.$scope.route||t.$mp&&t.$mp.page.route},B=e=>{let t=e&&(e.$page||e.$scope&&e.$scope.$page),i=uni.getStorageSync("_STAT_LAST_PAGE_ROUTE");return t?"/"===t.fullPath?t.route:t.fullPath||t.route:i||""},q=()=>{let e=getCurrentPages(),t=e[e.length-1];return t?t.$vm:null},$=e=>"page"===e.mpType||"page"===e.$mpType||e.$mp&&"page"===e.$mp.mpType||"page"===e.$options.mpType?"page":"app"===e.mpType||"app"===e.$mpType||e.$mp&&"app"===e.$mp.mpType||"app"===e.$options.mpType?"app":null,P=e=>{let t=[],i=[],n=[];for(let a in e){e[a].forEach((e=>{let s="";s=b(e),0===a?t.push(s):3===a?n.push(s):i.push(s)}))}return t.push(...i,...n),JSON.stringify(t)},C=e=>A&&A[e]||"",V="Report_Data_Time",H="Report_Status",U=e=>{let t={usv:_,conf:JSON.stringify({ak:"__UNI__CD46827"})};uni.request({url:f,method:"GET",data:t,success:t=>{const{data:i}=t;0===i.ret&&"function"==typeof e&&e({enable:i.enable})},fail:t=>{let i=1;try{i=uni.getStorageSync(H)}catch(n){i=1}""===i&&(i=1),"function"==typeof e&&e({enable:i})}})},M=()=>{if(T.collectItems){const e=T.collectItems.uniStatPageLog;return void 0===e||("boolean"!=typeof e||e)}return!0},O="__first__visit__time",j="__last__visit__time",W=()=>parseInt((new Date).getTime()/1e3),G=()=>{const e=S(O);let t=0;return e?t=e:(t=W(),w(O,t),k(j)),t},F="__page__residence__time";let z=0,J=0;const K=()=>(z=W(),w(F,z),z),Q="__total__visit__count",X=()=>{const e=S(Q);let t=1;return e&&(t=e,t++),w(Q,t),t},Y="__first_time",Z=()=>{let e=W();return w(Y,e)},ee=e=>{let t=0;const i=S(Y),n=W();if(0!==i&&(t=n-i),t=t<1?1:t,"app"===e){return{residenceTime:t,overtime:t>300}}if("page"===e){return{residenceTime:t,overtime:t>1800}}return{residenceTime:t}},te=(e=>{let t=T.reportInterval;if(0===Number(t))return 0;t=t||e;return/(^[1-9]\d*$)/.test(t)?Number(t):e})(10);let ie={uuid:y.deviceId||E(),ak:x.appid,p:"",ut:N(),mpn:(()=>{let e="";return"wx"!==N()&&"qq"!==N()||uni.canIUse("getAccountInfoSync")&&(e=uni.getAccountInfoSync().miniProgram.appId||""),N(),e})(),usv:_,v:"n"===N()?plus.runtime.version:"",ch:(()=>{let e="";return"n"===N()&&(e=plus.runtime.channel),e})(),cn:"",pn:"",ct:"",t:W(),tt:"",brand:y.brand||"",md:y.model,sv:"",mpsdk:y.SDKVersion||"",mpv:y.version||"",lang:y.language,pr:y.pixelRatio,ww:y.windowWidth,wh:y.windowHeight,sw:y.screenWidth,sh:y.screenHeight};if(y.platform)switch(y.platform){case"android":ie.p="a";break;case"ios":ie.p="i";break;case"harmonyos":ie.p="h"}y.system&&(ie.sv=y.system.replace(/(Android|iOS)\s/,""));class ne extends class{constructor(){this.self="",this.__licationShow=!1,this.__licationHide=!1,this.statData=ie,this._navigationBarTitle={config:"",page:"",report:"",lt:""},this._query={},"function"==typeof uni.addInterceptor&&(this.addInterceptorInit(),this.interceptLogin(),this.interceptShare(!0),this.interceptRequestPayment())}addInterceptorInit(){let e=this;uni.addInterceptor("setNavigationBarTitle",{invoke(t){e._navigationBarTitle.page=t.title}})}interceptLogin(){let e=this;uni.addInterceptor("login",{complete(){e._login()}})}interceptShare(e){let t=this;e?uni.addInterceptor("share",{success(){t._share()},fail(){t._share()}}):t._share()}interceptRequestPayment(){let e=this;uni.addInterceptor("requestPayment",{success(){e._payment("pay_success")},fail(){e._payment("pay_fail")}})}_login(){this.sendEventRequest({key:"login"},0)}_share(){this.sendEventRequest({key:"share"},0)}_payment(e){this.sendEventRequest({key:e},0)}applicationShow(){if(this.__licationHide){if(ee("app").overtime){let e={path:uni.getStorageSync("_STAT_LAST_PAGE_ROUTE"),scene:this.statData.sc,cst:2};this.sendReportRequest(e)}else{const e=R();if(e!==this.statData.sc){let t={path:uni.getStorageSync("_STAT_LAST_PAGE_ROUTE"),scene:e,cst:2};this.sendReportRequest(t)}}this.__licationHide=!1}}applicationHide(e,t){e||(e=q()),this.__licationHide=!0;const i=ee(),n=B(e);uni.setStorageSync("_STAT_LAST_PAGE_ROUTE",n),this.sendHideRequest({urlref:n,urlref_ts:i.residenceTime},t),Z()}pageShow(e){this._navigationBarTitle={config:"",page:"",report:"",lt:""};const t=B(e),i=L(e);if(this._navigationBarTitle.config=C(i),this.__licationShow)return Z(),uni.setStorageSync("_STAT_LAST_PAGE_ROUTE",t),void(this.__licationShow=!1);if(ee("page").overtime){let e={path:t,scene:this.statData.sc,cst:3};this.sendReportRequest(e)}Z()}pageHide(e){if(!this.__licationHide){const t=ee("page");let i=B(e),n=uni.getStorageSync("_STAT_LAST_PAGE_ROUTE");return n||(n=i),uni.setStorageSync("_STAT_LAST_PAGE_ROUTE",i),void this.sendPageRequest({url:i,urlref:n,urlref_ts:t.residenceTime})}}sendReportRequest(e,t){this._navigationBarTitle.lt="1",this._navigationBarTitle.config=C(e.path);let i=e.query&&"{}"!==JSON.stringify(e.query)?"?"+JSON.stringify(e.query):"";const n=(()=>{const e=S(j);let t=0;return e&&(t=e),w(j,W()),t})();if(0!==n||!n){const e=(e=>{let t="";if("n"===N()){try{t=plus.device.uuid}catch(i){t=""}return t}return y.deviceId||E()})();this.statData.odid=e}Object.assign(this.statData,{lt:"1",url:e.path+i||"",t:W(),sc:R(e.scene),fvts:G(),lvts:n,tvc:X(),cst:e.cst||1}),"n"===N()?this.getProperty(t):this.getNetworkInfo(t)}sendPageRequest(e){let{url:t,urlref:i,urlref_ts:n}=e;this._navigationBarTitle.lt="11";let a={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"11",ut:this.statData.ut,url:t,tt:this.statData.tt,urlref:i,urlref_ts:n,ch:this.statData.ch,usv:this.statData.usv,t:W()};this.request(a)}sendHideRequest(e,t){let{urlref:i,urlref_ts:n}=e,a={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"3",ut:this.statData.ut,urlref:i,urlref_ts:n,ch:this.statData.ch,usv:this.statData.usv,t:W()};this.request(a,t)}sendEventRequest({key:e="",value:t=""}={}){let i="";try{i=L()}catch(a){i=S("__launch_options").path}this._navigationBarTitle.config=C(i),this._navigationBarTitle.lt="21";let n={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"21",ut:this.statData.ut,url:i,ch:this.statData.ch,e_n:e,e_v:"object"==typeof t?JSON.stringify(t):t.toString(),usv:this.statData.usv,t:W()};this.request(n)}sendPushRequest(e,t){let i=W();const n={lt:"101",cid:t,t:i,ut:this.statData.ut},a=P({101:[n]});let s={usv:_,t:i,requests:a};"h5"!==n.ut?"n"!==N()||"a"!==this.statData.p?this.sendRequest(s):setTimeout((()=>{this.sendRequest(s)}),200):this.imageRequest(s)}getProperty(e){plus.runtime.getProperty(plus.runtime.appid,(t=>{this.statData.v=t.version||"",this.getNetworkInfo(e)}))}getNetworkInfo(e){uni.getNetworkType({success:t=>{this.statData.net=t.networkType,this.getLocation(e)}})}getLocation(e){x.getLocation?uni.getLocation({type:"wgs84",geocode:!0,success:t=>{t.address&&(this.statData.cn=t.address.country,this.statData.pn=t.address.province,this.statData.ct=t.address.city),this.statData.lat=t.latitude,this.statData.lng=t.longitude,this.request(this.statData,e)}}):(this.statData.lat=0,this.statData.lng=0,this.request(this.statData,e))}request(e,t){let i=W();const n=this._navigationBarTitle;Object.assign(e,{ttn:n.page,ttpj:n.config,ttc:n.report});let a=S("__UNI__STAT__DATA")||{};if(a[e.lt]||(a[e.lt]=[]),a[e.lt].push(e),w("__UNI__STAT__DATA",a),(J=W(),z=S(F),J-z)<te&&!t)return;K();const s=P(a);let r={usv:_,t:i,requests:s};k("__UNI__STAT__DATA"),"h5"!==e.ut?"n"!==N()||"a"!==this.statData.p?this.sendRequest(r):setTimeout((()=>{this.sendRequest(r)}),200):this.imageRequest(r)}getIsReportData(){return new Promise(((e,t)=>{let i="",n=(new Date).getTime(),a=1;try{i=uni.getStorageSync(V),a=uni.getStorageSync(H)}catch(s){i="",a=1}""!==a?(1===a&&e(),i||(uni.setStorageSync(V,n),i=n),n-i>864e5&&U((({enable:e})=>{uni.setStorageSync(V,n),uni.setStorageSync(H,e)}))):U((({enable:t})=>{uni.setStorageSync(V,n),uni.setStorageSync(H,t),1===t&&e()}))}))}sendRequest(e){this.getIsReportData().then((()=>{uni.request({url:f,method:"POST",data:e,success:()=>{},fail:t=>{++this._retry<3&&setTimeout((()=>{this.sendRequest(e)}),1e3)}})}))}imageRequest(e){this.getIsReportData().then((()=>{let t=new Image,i=(e=>{let t=Object.keys(e).sort(),i={},n="";for(var a in t)i[t[a]]=e[t[a]],n+=t[a]+"="+e[t[a]]+"&";return{sign:"",options:n.substr(0,n.length-1)}})((e=>{let t={};for(let i in e)t[i]=encodeURIComponent(e[i]);return t})(e)).options;t.src="https://tongji.dcloud.io/uni/stat.gif?"+i}))}sendEvent(e,t){var i,n;(n=t,(i=e)?"string"!=typeof i?(console.error("uni.report [eventName] Parameter type error, it can only be of type String"),1):i.length>255?(console.error("uni.report [eventName] Parameter length cannot be greater than 255"),1):"string"!=typeof n&&"object"!=typeof n?(console.error("uni.report [options] Parameter type error, Only supports String or Object type"),1):"string"==typeof n&&n.length>255?(console.error("uni.report [options] Parameter length cannot be greater than 255"),1):"title"===i&&"string"!=typeof n?(console.error("uni.report [eventName] When the parameter is title, the [options] parameter can only be of type String"),1):void 0:(console.error("uni.report Missing [eventName] parameter"),1))||("title"!==e?this.sendEventRequest({key:e,value:"object"==typeof t?JSON.stringify(t):t},1):this._navigationBarTitle.report=t)}}{static getInstance(){return uni.__stat_instance||(uni.__stat_instance=new ne),uni.__stat_instance}constructor(){super()}pushEvent(e){const t=(()=>{if(T.collectItems){const e=T.collectItems.uniPushClientID;return"boolean"==typeof e&&e}return!1})();uni.getPushClientId&&t&&uni.getPushClientId({success:t=>{const i=t.cid||!1;i&&this.sendPushRequest(e,i)}})}launch(e,t){K(),this.__licationShow=!0,w("__launch_options",e),e.cst=1,this.sendReportRequest(e,!0)}load(e,t){this.self=t,this._query=e}appHide(e){this.applicationHide(e,!0)}appShow(e){this.applicationShow(e)}show(e){if(this.self=e,"page"===$(e)){M()&&this.pageShow(e)}"h5"!==N()&&"n"!==N()||"app"===$(e)&&this.appShow()}hide(e){if(this.self=e,"page"===$(e)){M()&&this.pageHide(e)}"h5"!==N()&&"n"!==N()||"app"===$(e)&&this.appHide()}error(e){let t="";t=e.message?e.stack:JSON.stringify(e);let i="";try{i=L()}catch(a){i=""}let n={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"31",url:i,ut:this.statData.ut,ch:this.statData.ch,mpsdk:this.statData.mpsdk,mpv:this.statData.mpv,v:this.statData.v,em:t,usv:this.statData.usv,t:parseInt((new Date).getTime()/1e3)};this.request(n)}}const ae=ne.getInstance();let se=!1;const re={onLaunch(e){ae.launch(e,this),ae.pushEvent(e)},onLoad(e){if(ae.load(e,this),this.$scope&&this.$scope.onShareAppMessage){let e=this.$scope.onShareAppMessage;this.$scope.onShareAppMessage=function(t){return ae.interceptShare(!1),e.call(this,t)}}},onShow(){se=!1,ae.show(this)},onHide(){se=!0,ae.hide(this)},onUnload(){se?se=!1:ae.hide(this)},onError(e){ae.error(e)}};uni.onCreateVueApp((e=>{e.mixin(re),uni.report=function(e,t){ae.sendEvent(e,t)}})),"h5"!==N()&&"n"!==N()&&(uni.onAppHide((()=>{ae.appHide(q())})),uni.onAppShow((()=>{ae.appShow(q())})));const{app:oe,Vuex:le,Pinia:ce}={app:e.createVueApp(m)};uni.Vuex=le,uni.Pinia=ce,oe.provide("__globalStyles",__uniConfig.styles),oe._component.mpType="app",oe._component.render=()=>{},oe.mount("#app")}(Vue);
